ggplot(seaweed_grouped_top_N, aes(x = X.SampleID, y = abundance/seaweed_total_abundance, fill = ASV))+
geom_bar(stat = "identity", position = "stack", color = "white")+ # stack shows different height, fill makes the same
expand_limits(y=c(0,1))+ # add y scale maximum: "1.00" to the plot
facet_grid(~Genus, scales = "free_x", space = "free") + # ignore blank spaces, make different regions have different widths
labs(x = "Sample", y = "Relative abundance") +
theme_bw()+
theme(legend.position = "none",
axis.text.x = element_blank(), # hide x axis names
axis.ticks.x = element_blank()) + # hide x axis ticks
scale_fill_manual(values = my_colors)+
scale_y_continuous(expand=c(0,0))
ggplot(seaweed_grouped_top_N, aes(x = X.SampleID, y = abundance/seaweed_total_abundance, fill = ASV))+
geom_bar(stat = "identity", position = "stack", color = "white")+ # stack shows different height, fill makes the same
expand_limits(y=c(0,1))+ # add y scale maximum: "1.00" to the plot
facet_grid(~Site, scales = "free_x", space = "free") + # ignore blank spaces, make different regions have different widths
labs(x = "Sample", y = "Relative abundance") +
theme_bw()+
theme(legend.position = "none",
axis.text.x = element_blank(), # hide x axis names
axis.ticks.x = element_blank()) + # hide x axis ticks
scale_fill_manual(values = my_colors)+
scale_y_continuous(expand=c(0,0))
starfish = filter(kelp_more_reads, Site == "Starfish.Island")
starfish_metadata = starfish[,(1:21)] # starfish metadata
starfish_otu = starfish[,-(1:21)] # starfish otu
# gather OTU names and abundances
starfish_grouped = gather(starfish, key = "ASV", value = "abundance", -(1:21))
# get abundance for each OTU in all samples
starfish_total_abundance = colSums(starfish_otu)
N = 15
starfish_top_N_abundance = names(sort(starfish_total_abundance, decreasing = TRUE)[1:N]) # top N abundance's name
# get abundance of all OTUs in each sample
starfish_total_abundance = rowSums(starfish_otu) # calculate total abundance
starfish_metadata = cbind(starfish_metadata, starfish_total_abundance) # add total abundance as a new column
starfish = as.data.frame(cbind(starfish_metadata, starfish_otu)) # update kelp_otu_metadata
starfish_grouped_top_N = filter(starfish_grouped, ASV %in% starfish_top_N_abundance) # keep rows only where ASV is top N abundance
# plot: top N OTUs in different sample types
ggplot(seaweed_grouped_top_N, aes(x = X.SampleID, y = abundance/starfish_total_abundance, fill = ASV))+
geom_bar(stat = "identity", position = "stack", color = "white")+ # stack shows different height, fill makes the same
expand_limits(y=c(0,1))+ # add y scale maximum: "1.00" to the plot
facet_grid(~Sample_type, scales = "free_x", space = "free") + # ignore blank spaces, make different regions have different widths
labs(x = "Sample", y = "Relative abundance") +
theme_bw()+
theme(legend.position = "none",
axis.text.x = element_blank(), # hide x axis names
axis.ticks.x = element_blank()) + # hide x axis ticks
scale_fill_manual(values = my_colors)+
scale_y_continuous(expand=c(0,0))
ggplot(starfish_grouped_top_N, aes(x = X.SampleID, y = abundance/starfish_total_abundance, fill = ASV))+
geom_bar(stat = "identity", position = "stack", color = "white")+ # stack shows different height, fill makes the same
expand_limits(y=c(0,1))+ # add y scale maximum: "1.00" to the plot
facet_grid(~Sample_type, scales = "free_x", space = "free") + # ignore blank spaces, make different regions have different widths
labs(x = "Sample", y = "Relative abundance") +
theme_bw()+
theme(legend.position = "none",
axis.text.x = element_blank(), # hide x axis names
axis.ticks.x = element_blank()) + # hide x axis ticks
scale_fill_manual(values = my_colors)+
scale_y_continuous(expand=c(0,0))
View(kelp_more_reads)
# gather OTU names and abundances
kelp_grouped = gather(kelp_more_reads, key = "ASV", value = "abundance", -(1:21))
# get abundance for each OTU in all samples
kelp_total_abundance = colSums(kelp_otu)
N = 15
kelp_top_N_abundance = names(sort(kelp_total_abundance, decreasing = TRUE)[1:N]) # top N abundance's name
# get abundance of all OTUs in each sample
kelp_total_abundance = rowSums(kelp_otu) # calculate total abundance
kelp_metadata = cbind(kelp_metadata,kelp_total_abundance) # add total abundance as a new column
kelp = as.data.frame(cbind(kelp_metadata,kelp_otu)) # update kelp_otu_metadata
kelp_grouped_top_N = filter(kelp_grouped, ASV %in% kelp_top_N_abundance) # keep rows only where ASV is top N abundance
# plot: top N OTUs in different sample types
ggplot(kelp_grouped_top_N, aes(x = X.SampleID, y = abundance/kelp_total_abundance, fill = ASV))+
geom_bar(stat = "identity", position = "stack", color = "white")+ # stack shows different height, fill makes the same
expand_limits(y=c(0,1))+ # add y scale maximum: "1.00" to the plot
facet_grid(~Sample_type, scales = "free_x", space = "free") + # ignore blank spaces, make different regions have different widths
labs(x = "Sample", y = "Relative abundance") +
theme_bw()+
theme(legend.position = "none",
axis.text.x = element_blank(), # hide x axis names
axis.ticks.x = element_blank()) + # hide x axis ticks
scale_fill_manual(values = my_colors)+
scale_y_continuous(expand=c(0,0))
# gather OTU names and abundances
kelp_grouped = gather(kelp_otu_metadata, key = "ASV", value = "abundance", -(1:21))
# get abundance for each OTU in all samples
kelp_total_abundance = colSums(kelp_otu)
N = 15
kelp_top_N_abundance = names(sort(kelp_total_abundance, decreasing = TRUE)[1:N]) # top N abundance's name
# get abundance of all OTUs in each sample
kelp_total_abundance = rowSums(kelp_otu) # calculate total abundance
kelp_metadata = cbind(kelp_metadata,kelp_total_abundance) # add total abundance as a new column
kelp = as.data.frame(cbind(kelp_metadata,kelp_otu)) # update kelp_otu_metadata
kelp_grouped_top_N = filter(kelp_grouped, ASV %in% kelp_top_N_abundance) # keep rows only where ASV is top N abundance
# plot: top N OTUs in different sample types
ggplot(kelp_grouped_top_N, aes(x = X.SampleID, y = abundance/kelp_total_abundance, fill = ASV))+
geom_bar(stat = "identity", position = "stack", color = "white")+ # stack shows different height, fill makes the same
expand_limits(y=c(0,1))+ # add y scale maximum: "1.00" to the plot
facet_grid(~Sample_type, scales = "free_x", space = "free") + # ignore blank spaces, make different regions have different widths
labs(x = "Sample", y = "Relative abundance") +
theme_bw()+
theme(legend.position = "none",
axis.text.x = element_blank(), # hide x axis names
axis.ticks.x = element_blank()) + # hide x axis ticks
scale_fill_manual(values = my_colors)+
scale_y_continuous(expand=c(0,0))
## Task 5)
# gather OTU names and abundances
kelp_grouped = gather(kelp_otu_metadata, key = "ASV", value = "abundance", -(1:21))
# get abundance for each OTU in all samples
kelp_total_abundance = colSums(kelp_otu)
M = 20
kelp_top_N_abundance = names(sort(kelp_total_abundance, decreasing = TRUE)[1:N]) # top N abundance's name
# get abundance of all OTUs in each sample
kelp_total_abundance = rowSums(kelp_otu) # calculate total abundance
kelp_metadata = cbind(kelp_metadata,kelp_total_abundance) # add total abundance as a new column
kelp = as.data.frame(cbind(kelp_metadata,kelp_otu)) # update kelp_otu_metadata
kelp_grouped_top_N = filter(kelp_grouped, ASV %in% kelp_top_N_abundance) # keep rows only where ASV is top N abundance
# plot: top N OTUs in different sample types
ggplot(kelp_grouped_top_N, aes(x = X.SampleID, y = abundance/kelp_total_abundance, fill = ASV))+
geom_bar(stat = "identity", position = "stack", color = "white")+ # stack shows different height, fill makes the same
expand_limits(y=c(0,1))+ # add y scale maximum: "1.00" to the plot
facet_grid(~Sample_type, scales = "free_x", space = "free") + # ignore blank spaces, make different regions have different widths
labs(x = "Sample", y = "Relative abundance") +
theme_bw()+
theme(legend.position = "none",
axis.text.x = element_blank(), # hide x axis names
axis.ticks.x = element_blank()) + # hide x axis ticks
scale_fill_manual(values = my_colors)+
scale_y_continuous(expand=c(0,0))
## Task 5)
# gather OTU names and abundances
kelp_grouped = gather(kelp_otu_metadata, key = "ASV", value = "abundance", -(1:21))
# get abundance for each OTU in all samples
kelp_total_abundance = colSums(kelp_otu)
M = 25
kelp_top_N_abundance = names(sort(kelp_total_abundance, decreasing = TRUE)[1:N]) # top N abundance's name
# get abundance of all OTUs in each sample
kelp_total_abundance = rowSums(kelp_otu) # calculate total abundance
kelp_metadata = cbind(kelp_metadata,kelp_total_abundance) # add total abundance as a new column
kelp = as.data.frame(cbind(kelp_metadata,kelp_otu)) # update kelp_otu_metadata
kelp_grouped_top_N = filter(kelp_grouped, ASV %in% kelp_top_N_abundance) # keep rows only where ASV is top N abundance
# plot: top N OTUs in different sample types
ggplot(kelp_grouped_top_N, aes(x = X.SampleID, y = abundance/kelp_total_abundance, fill = ASV))+
geom_bar(stat = "identity", position = "stack", color = "white")+ # stack shows different height, fill makes the same
expand_limits(y=c(0,1))+ # add y scale maximum: "1.00" to the plot
facet_grid(~Sample_type, scales = "free_x", space = "free") + # ignore blank spaces, make different regions have different widths
labs(x = "Sample", y = "Relative abundance") +
theme_bw()+
theme(legend.position = "none",
axis.text.x = element_blank(), # hide x axis names
axis.ticks.x = element_blank()) + # hide x axis ticks
scale_fill_manual(values = my_colors)+
scale_y_continuous(expand=c(0,0))
## Task 5)
# gather OTU names and abundances
kelp_grouped = gather(kelp_otu_metadata, key = "ASV", value = "abundance", -(1:21))
# get abundance for each OTU in all samples
kelp_total_abundance = colSums(kelp_otu)
M = 20
kelp_top_N_abundance = names(sort(kelp_total_abundance, decreasing = TRUE)[1:N]) # top N abundance's name
# get abundance of all OTUs in each sample
kelp_total_abundance = rowSums(kelp_otu) # calculate total abundance
kelp_metadata = cbind(kelp_metadata,kelp_total_abundance) # add total abundance as a new column
kelp = as.data.frame(cbind(kelp_metadata,kelp_otu)) # update kelp_otu_metadata
kelp_grouped_top_N = filter(kelp_grouped, ASV %in% kelp_top_N_abundance) # keep rows only where ASV is top N abundance
# plot: top N OTUs in different sample types
ggplot(kelp_grouped_top_N, aes(x = X.SampleID, y = abundance/kelp_total_abundance, fill = ASV))+
geom_bar(stat = "identity", position = "stack", color = "white")+ # stack shows different height, fill makes the same
expand_limits(y=c(0,1))+ # add y scale maximum: "1.00" to the plot
facet_grid(~Sample_type, scales = "free_x", space = "free") + # ignore blank spaces, make different regions have different widths
labs(x = "Sample", y = "Relative abundance") +
theme_bw()+
theme(legend.position = "none",
axis.text.x = element_blank(), # hide x axis names
axis.ticks.x = element_blank()) + # hide x axis ticks
scale_fill_manual(values = my_colors)+
scale_y_continuous(expand=c(0,0))
ggplot(kelp_grouped_top_N, aes(x = X.SampleID, y = abundance/kelp_total_abundance, fill = ASV))+
geom_bar(stat = "identity", position = "stack", color = "white")+ # stack shows different height, fill makes the same
expand_limits(y=c(0,1))+ # add y scale maximum: "1.00" to the plot
facet_grid(~Sample_type, scales = "free_x", space = "free") + # ignore blank spaces, make different regions have different widths
labs(x = "Sample", y = "Relative abundance") +
theme_bw()+
theme(axis.text.x = element_blank(), # hide x axis names
axis.ticks.x = element_blank()) + # hide x axis ticks
scale_fill_manual(values = my_colors)+
scale_y_continuous(expand=c(0,0))
# plot: top N OTUs in different sample types
Sample_type.labs <- c("Rock", "Seaweed", "Water")
ggplot(kelp_grouped_top_N, aes(x = X.SampleID, y = abundance/kelp_total_abundance, fill = ASV))+
geom_bar(stat = "identity", position = "stack", color = "white")+ # stack shows different height, fill makes the same
expand_limits(y=c(0,1))+ # add y scale maximum: "1.00" to the plot
facet_grid(~Sample_type, scales = "free_x", space = "free",
labeller = labeller(Sample_type = Sample_type.labs)) + # ignore blank spaces, make different regions have different widths
labs(x = "Sample", y = "Relative abundance") +
theme_bw()+
theme(axis.text.x = element_blank(), # hide x axis names
axis.ticks.x = element_blank()) + # hide x axis ticks
scale_fill_manual(values = my_colors)+
scale_y_continuous(expand=c(0,0))+
Sample_type.labs <- c("Rock", "Seaweed", "Water")
ggplot(kelp_grouped_top_N, aes(x = X.SampleID, y = abundance/kelp_total_abundance, fill = ASV))+
geom_bar(stat = "identity", position = "stack", color = "white")+ # stack shows different height, fill makes the same
expand_limits(y=c(0,1))+ # add y scale maximum: "1.00" to the plot
facet_grid(~Sample_type, scales = "free_x", space = "free",
labeller = labeller(Sample_type = Sample_type.labs)) + # ignore blank spaces, make different regions have different widths
labs(x = "Sample", y = "Relative abundance") +
theme_bw()+
theme(axis.text.x = element_blank(), # hide x axis names
axis.ticks.x = element_blank()) + # hide x axis ticks
scale_fill_manual(values = my_colors)+
scale_y_continuous(expand=c(0,0))+
scale_colour_discrete(name="OTU")
Sample_type.labs <- c("Rock", "Seaweed", "Water")
ggplot(kelp_grouped_top_N, aes(x = X.SampleID, y = abundance/kelp_total_abundance, fill = ASV))+
geom_bar(stat = "identity", position = "stack", color = "white")+ # stack shows different height, fill makes the same
expand_limits(y=c(0,1))+ # add y scale maximum: "1.00" to the plot
facet_grid(~Sample_type, scales = "free_x", space = "free",
labeller = labeller(Sample_type = Sample_type.labs)) + # ignore blank spaces, make different regions have different widths
labs(x = "Sample", y = "Relative abundance") +
theme_bw()+
theme(axis.text.x = element_blank(), # hide x axis names
axis.ticks.x = element_blank()) + # hide x axis ticks
scale_colour_discrete(name="OTU")+
scale_fill_manual(values = my_colors)+
scale_y_continuous(expand=c(0,0))
Sample_type.labs <- c("Rock", "Seaweed", "Water")
ggplot(kelp_grouped_top_N, aes(x = X.SampleID, y = abundance/kelp_total_abundance, fill = ASV))+
geom_bar(stat = "identity", position = "stack", color = "white")+ # stack shows different height, fill makes the same
expand_limits(y=c(0,1))+ # add y scale maximum: "1.00" to the plot
facet_grid(~Sample_type, scales = "free_x", space = "free",
labeller = labeller(Sample_type = Sample_type.labs)) + # ignore blank spaces, make different regions have different widths
labs(x = "Sample", y = "Relative abundance") +
theme_bw()+
scale_colour_discrete(name="OTU")+
theme(axis.text.x = element_blank(), # hide x axis names
axis.ticks.x = element_blank()) + # hide x axis ticks
scale_fill_manual(values = my_colors)+
scale_y_continuous(expand=c(0,0))
type.labs <- c("Rock", "Seaweed", "Water")
ggplot(kelp_grouped_top_N, aes(x = X.SampleID, y = abundance/kelp_total_abundance, fill = ASV))+
geom_bar(stat = "identity", position = "stack", color = "white")+ # stack shows different height, fill makes the same
expand_limits(y=c(0,1))+ # add y scale maximum: "1.00" to the plot
facet_grid(~Sample_type, scales = "free_x", space = "free",
labeller = labeller(Sample_type = type.labs)) + # ignore blank spaces, make different regions have different widths
labs(x = "Sample", y = "Relative abundance") +
theme_bw()+
scale_colour_discrete(name="OTU")+
theme(axis.text.x = element_blank(), # hide x axis names
axis.ticks.x = element_blank()) + # hide x axis ticks
scale_fill_manual(values = my_colors)+
scale_y_continuous(expand=c(0,0))
type.labs <- c("Rock", "Seaweed", "Water")
names(type.labs) <- c("rock", "seaweed", "water")
ggplot(kelp_grouped_top_N, aes(x = X.SampleID, y = abundance/kelp_total_abundance, fill = ASV))+
geom_bar(stat = "identity", position = "stack", color = "white")+ # stack shows different height, fill makes the same
expand_limits(y=c(0,1))+ # add y scale maximum: "1.00" to the plot
facet_grid(~Sample_type, scales = "free_x", space = "free",
labeller = labeller(Sample_type = type.labs)) + # ignore blank spaces, make different regions have different widths
labs(x = "Sample", y = "Relative abundance") +
theme_bw()+
scale_colour_discrete(name="OTU")+
theme(axis.text.x = element_blank(), # hide x axis names
axis.ticks.x = element_blank()) + # hide x axis ticks
scale_fill_manual(values = my_colors)+
scale_y_continuous(expand=c(0,0))
type.labs <- c("Rock", "Seaweed", "Water")
names(type.labs) <- c("rock", "seaweed", "water") # change text of facet labels
ggplot(kelp_grouped_top_N, aes(x = X.SampleID, y = abundance/kelp_total_abundance, fill = ASV))+
geom_bar(stat = "identity", position = "stack", color = "white")+ # stack shows different height, fill makes the same
expand_limits(y=c(0,1))+ # add y scale maximum: "1.00" to the plot
facet_grid(~Sample_type, scales = "free_x", space = "free",
labeller = labeller(Sample_type = type.labs)) + # ignore blank spaces, make different regions have different widths
labs(x = "Sample", y = "Relative abundance") +
theme_bw()+
theme(axis.text.x = element_blank(), # hide x axis names
axis.ticks.x = element_blank()) + # hide x axis ticks
scale_fill_manual(values = my_colors)+
scale_y_continuous(expand=c(0,0))
type.labs <- c("Rock", "Seaweed", "Water")
names(type.labs) <- c("rock", "seaweed", "water") # change text of facet labels
ggplot(kelp_grouped_top_N, aes(x = X.SampleID, y = abundance/kelp_total_abundance, fill = ASV))+
geom_bar(stat = "identity", position = "stack", color = "white")+ # stack shows different height, fill makes the same
expand_limits(y=c(0,1))+ # add y scale maximum: "1.00" to the plot
facet_grid(~Sample_type, scales = "free_x", space = "free",
labeller = labeller(Sample_type = type.labs)) + # ignore blank spaces, make different regions have different widths
labs(x = "Sample", fill = "OTU",y = "Relative abundance") +
theme_bw()+
theme(axis.text.x = element_blank(), # hide x axis names
axis.ticks.x = element_blank()) + # hide x axis ticks
scale_fill_manual(values = my_colors)+
scale_y_continuous(expand=c(0,0))
ggplot(seaweed_grouped_top_N, aes(x = X.SampleID, y = abundance/seaweed_total_abundance, fill = ASV))+
geom_bar(stat = "identity", position = "stack", color = "white")+ # stack shows different height, fill makes the same
expand_limits(y=c(0,1))+ # add y scale maximum: "1.00" to the plot
facet_grid(~Site, scales = "free_x", space = "free") + # ignore blank spaces, make different regions have different widths
labs(x = "Sample", y = "Relative abundance") +
theme_bw()+
theme(axis.text.x = element_blank(), # hide x axis names
axis.ticks.x = element_blank()) + # hide x axis ticks
scale_fill_manual(values = my_colors)+
scale_y_continuous(expand=c(0,0))
seaweed_total_abundance = colSums(seaweed_otu)
N = 15
seaweed_top_N_abundance = names(sort(seaweed_total_abundance, decreasing = TRUE)[1:N])
seaweed_total_abundance = rowSums(seaweed_otu) # calculate total abundance
seaweed_metadata = cbind(seaweed_metadata, seaweed_total_abundance) # add total abundance as a new column
seaweed = as.data.frame(cbind(seaweed_metadata, seaweed_otu)) # update kelp_otu_metadata
seaweed_grouped_top_N = filter(seaweed_grouped, ASV %in% seaweed_top_N_abundance)
type.labs <- c("Golden Island", "Starfish Island", "Triquet Bay", "West Beach")
names(type.labs) <- c("Golden.Island", "Starfish.Island", "Triquet.Bay", "West.Beach")
ggplot(seaweed_grouped_top_N, aes(x = X.SampleID, y = abundance/seaweed_total_abundance, fill = ASV))+
geom_bar(stat = "identity", position = "stack", color = "white")+ # stack shows different height, fill makes the same
expand_limits(y=c(0,1))+ # add y scale maximum: "1.00" to the plot
facet_grid(~Site, scales = "free_x", space = "free") + # ignore blank spaces, make different regions have different widths
labs(x = "Sample",fill = "OTU", y = "Relative abundance") +
theme_bw()+
theme(axis.text.x = element_blank(), # hide x axis names
axis.ticks.x = element_blank()) + # hide x axis ticks
scale_fill_manual(values = my_colors)+
scale_y_continuous(expand=c(0,0))
type.labs <- c("Golden Island", "Starfish Island", "Triquet Bay", "West Beach")
names(type.labs) <- c("Golden.Island", "Starfish.Island", "Triquet.Bay", "West.Beach")
ggplot(seaweed_grouped_top_N, aes(x = X.SampleID, y = abundance/seaweed_total_abundance, fill = ASV))+
geom_bar(stat = "identity", position = "stack", color = "white")+ # stack shows different height, fill makes the same
expand_limits(y=c(0,1))+ # add y scale maximum: "1.00" to the plot
facet_grid(~Site, scales = "free_x", space = "free",
labeller = labeller(Sample_type = type.labs)) + # ignore blank spaces, make different regions have different widths
labs(x = "Sample",fill = "OTU", y = "Relative abundance") +
theme_bw()+
theme(axis.text.x = element_blank(), # hide x axis names
axis.ticks.x = element_blank()) + # hide x axis ticks
scale_fill_manual(values = my_colors)+
scale_y_continuous(expand=c(0,0))
site.labs <- c("Golden Island", "Starfish Island", "Triquet Bay", "West Beach")
names(site.labs) <- c("Golden.Island", "Starfish.Island", "Triquet.Bay", "West.Beach")
ggplot(seaweed_grouped_top_N, aes(x = X.SampleID, y = abundance/seaweed_total_abundance, fill = ASV))+
geom_bar(stat = "identity", position = "stack", color = "white")+ # stack shows different height, fill makes the same
expand_limits(y=c(0,1))+ # add y scale maximum: "1.00" to the plot
facet_grid(~Site, scales = "free_x", space = "free",
labeller = labeller(Sample_type = site.labs)) + # ignore blank spaces, make different regions have different widths
labs(x = "Sample",fill = "OTU", y = "Relative abundance") +
theme_bw()+
theme(axis.text.x = element_blank(), # hide x axis names
axis.ticks.x = element_blank()) + # hide x axis ticks
scale_fill_manual(values = my_colors)+
scale_y_continuous(expand=c(0,0))
site.labs <- c("Golden Island", "Starfish Island", "Triquet Bay", "West Beach")
names(site.labs) <- c("Golden.Island", "Starfish.Island", "Triquet.Bay", "West.Beach")
ggplot(seaweed_grouped_top_N, aes(x = X.SampleID, y = abundance/seaweed_total_abundance, fill = ASV))+
geom_bar(stat = "identity", position = "stack", color = "white")+ # stack shows different height, fill makes the same
expand_limits(y=c(0,1))+ # add y scale maximum: "1.00" to the plot
facet_grid(~Site, scales = "free_x", space = "free",
labeller = labeller(Site = site.labs)) + # ignore blank spaces, make different regions have different widths
labs(x = "Sample",fill = "OTU", y = "Relative abundance") +
theme_bw()+
theme(axis.text.x = element_blank(), # hide x axis names
axis.ticks.x = element_blank()) + # hide x axis ticks
scale_fill_manual(values = my_colors)+
scale_y_continuous(expand=c(0,0))
ggplot(seaweed_grouped, aes(x = X.SampleID, y = abundance, fill = ASV))+
geom_bar(stat = "identity", position = "fill", color = "white")+
facet_grid(~Site, scales = "free_x", space = "free") +
labs(x = "Sample", y = "Relative abundance") +
theme_bw() +
theme(legend.position = "none",
axis.text.x = element_blank(),
axis.ticks.x = element_blank())+
scale_y_continuous(expand=c(0,0))
site.labs <- c("Golden Island", "Starfish Island", "Triquet Bay", "West Beach")
names(site.labs) <- c("Golden.Island", "Starfish.Island", "Triquet.Bay", "West.Beach")
ggplot(seaweed_grouped, aes(x = X.SampleID, y = abundance, fill = ASV))+
geom_bar(stat = "identity", position = "fill", color = "white")+
facet_grid(~Site, scales = "free_x", space = "free",
labeller = labeller(Site = site.labs)) +
labs(x = "Sample", y = "Relative abundance") +
theme_bw() +
theme(legend.position = "none",
axis.text.x = element_blank(),
axis.ticks.x = element_blank())+
scale_y_continuous(expand=c(0,0))
ggplot(seaweed_grouped_top_N, aes(x = X.SampleID, y = abundance/seaweed_total_abundance, fill = ASV))+
geom_bar(stat = "identity", position = "stack", color = "white")+
expand_limits(y=c(0,1))+
facet_grid(~Site, scales = "free_x", space = "free",
labeller = labeller(Site = site.labs)) +
labs(x = "Sample",fill = "OTU", y = "Relative abundance") +
theme_bw()+
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank()) +
scale_fill_manual(values = my_colors)+
scale_y_continuous(expand=c(0,0))
View(kelp_grouped_top_N)
type.labs <- c("Seaweed", "Rock", "Water")
names(type.labs) <- c("seaweed", "rock", "water") # change text of facet labels
ggplot(kelp_grouped_top_N, aes(x = X.SampleID, y = abundance/kelp_total_abundance, fill = ASV))+
geom_bar(stat = "identity", position = "stack", color = "white")+ # stack shows different height, fill makes the same
expand_limits(y=c(0,1))+ # add y scale maximum "1.00" to the plot
facet_grid(~Sample_type, scales = "free_x", space = "free",
labeller = labeller(Sample_type = type.labs)) + # ignore blank spaces, make different regions have different widths
labs(x = "Sample", fill = "OTU",y = "Relative abundance") + # change legend title and axes' name
theme_bw()+
theme(axis.text.x = element_blank(), # hide x axis names
axis.ticks.x = element_blank()) + # hide x axis ticks
scale_fill_manual(values = my_colors)+
scale_y_continuous(expand=c(0,0))
type.labs <- c("Seaweed", "Rock", "Water")
names(type.labs) <- c("seaweed", "rock", "water") # change text of facet labels
kelp_grouped_top_N$sample_type_2 <- factor(kelp_grouped_top_N$Sample_type, levels=c("rock", "water", "seaweed"))
ggplot(kelp_grouped_top_N, aes(x = X.SampleID, y = abundance/kelp_total_abundance, fill = ASV))+
geom_bar(stat = "identity", position = "stack", color = "white")+ # stack shows different height, fill makes the same
expand_limits(y=c(0,1))+ # add y scale maximum "1.00" to the plot
facet_grid(~Sample_type, scales = "free_x", space = "free",
labeller = labeller(Sample_type = type.labs)) + # ignore blank spaces, make different regions have different widths
labs(x = "Sample", fill = "OTU",y = "Relative abundance") + # change legend title and axes' name
theme_bw()+
theme(axis.text.x = element_blank(), # hide x axis names
axis.ticks.x = element_blank()) + # hide x axis ticks
scale_fill_manual(values = my_colors)+
scale_y_continuous(expand=c(0,0))
type.labs <- c("Seaweed", "Rock", "Water")
names(type.labs) <- c("seaweed", "rock", "water") # change text of facet labels
kelp_grouped_top_N$sample_type_2 <- factor(kelp_grouped_top_N$Sample_type, levels=c("rock", "water", "seaweed"))
ggplot(kelp_grouped_top_N, aes(x = X.SampleID, y = abundance/kelp_total_abundance, fill = ASV))+
geom_bar(stat = "identity", position = "stack", color = "white")+ # stack shows different height, fill makes the same
expand_limits(y=c(0,1))+ # add y scale maximum "1.00" to the plot
facet_grid(~sample_type_2, scales = "free_x", space = "free",
labeller = labeller(Sample_type = type.labs)) + # ignore blank spaces, make different regions have different widths
labs(x = "Sample", fill = "OTU",y = "Relative abundance") + # change legend title and axes' name
theme_bw()+
theme(axis.text.x = element_blank(), # hide x axis names
axis.ticks.x = element_blank()) + # hide x axis ticks
scale_fill_manual(values = my_colors)+
scale_y_continuous(expand=c(0,0))
type.labs <- c("Seaweed", "Rock", "Water")
names(type.labs) <- c("seaweed", "rock", "water") # change text of facet labels
kelp_grouped_top_N$sample_type_2 <- factor(kelp_grouped_top_N$Sample_type, levels=c("rock", "water", "seaweed"))
ggplot(kelp_grouped_top_N, aes(x = X.SampleID, y = abundance/kelp_total_abundance, fill = ASV))+
geom_bar(stat = "identity", position = "stack", color = "white")+ # stack shows different height, fill makes the same
expand_limits(y=c(0,1))+ # add y scale maximum "1.00" to the plot
facet_grid(~sample_type_2, scales = "free_x", space = "free",
labeller = labeller(sample_type_2 = type.labs)) + # ignore blank spaces, make different regions have different widths
labs(x = "Sample", fill = "OTU",y = "Relative abundance") + # change legend title and axes' name
theme_bw()+
theme(axis.text.x = element_blank(), # hide x axis names
axis.ticks.x = element_blank()) + # hide x axis ticks
scale_fill_manual(values = my_colors)+
scale_y_continuous(expand=c(0,0))
## read dataset
# read kelp_otu
kelp_otu = read.table("Lemay_kelp_OTUtable.txt",
header = TRUE, sep = "\t",comment.char="&" ) # read OTU table
col_names_otu = kelp_otu$X.OTU.ID # store OTU.ID as future column names
kelp_otu = as.data.frame(kelp_otu[,-(1:2)]) # remove first 2 columns
kelp_otu = as.data.frame(t(kelp_otu[,-1])) # rotate columns and rows
names(kelp_otu) = col_names_otu # add OTU.ID as column names
kelp_otu <- cbind(X.SampleID = rownames(kelp_otu), data.frame(kelp_otu, row.names=NULL))
# add default row names, make samle ID as a column
# read kelp_metadata
kelp_metadata = read.table("Lemay_kelp_matadata.txt",
header = TRUE, sep = "\t", comment.char="&") # read metadata
kelp_metadata$X.SampleID = sub("-",".",kelp_metadata$X.SampleID) # replace "-" with "."
## store colors here
my_colors=c("#d13b00","#2e12bc","#a7b32f","#9d38e9","#256600","#ff69e2","#01be89","#ff2998",
"#655700","#0069d3","#f99128","#014d91","#ff3672","#ada0f4","#6c240b","#ff6ed2",
"#6e1c3b","#f488bf","#c50050","#6e4974")
################################## Before working ###########################################
################################## Start working ############################################
## Task 1)
# filter out samples that do not appear in both otu and metadata
kelp_otu_metadata = inner_join(kelp_metadata,kelp_otu,by="X.SampleID")
setwd("D:/BIOL448J_Lab/Lab04")
# load packages
library(tidyverse)
################################## Before working ###########################################
## read dataset
# read kelp_otu
kelp_otu = read.table("Lemay_kelp_OTUtable.txt",
header = TRUE, sep = "\t",comment.char="&" ) # read OTU table
col_names_otu = kelp_otu$X.OTU.ID # store OTU.ID as future column names
kelp_otu = as.data.frame(kelp_otu[,-(1:2)]) # remove first 2 columns
kelp_otu = as.data.frame(t(kelp_otu[,-1])) # rotate columns and rows
names(kelp_otu) = col_names_otu # add OTU.ID as column names
kelp_otu <- cbind(X.SampleID = rownames(kelp_otu), data.frame(kelp_otu, row.names=NULL))
# add default row names, make samle ID as a column
# read kelp_metadata
kelp_metadata = read.table("Lemay_kelp_matadata.txt",
header = TRUE, sep = "\t", comment.char="&") # read metadata
kelp_metadata$X.SampleID = sub("-",".",kelp_metadata$X.SampleID) # replace "-" with "."
## store colors here
my_colors=c("#d13b00","#2e12bc","#a7b32f","#9d38e9","#256600","#ff69e2","#01be89","#ff2998",
"#655700","#0069d3","#f99128","#014d91","#ff3672","#ada0f4","#6c240b","#ff6ed2",
"#6e1c3b","#f488bf","#c50050","#6e4974")
################################## Before working ###########################################
################################## Start working ############################################
## Task 1)
# filter out samples that do not appear in both otu and metadata
kelp_otu_metadata = inner_join(kelp_metadata,kelp_otu,by="X.SampleID")
View(kelp_metadata)
View(kelp_otu)
View(kelp_otu_metadata)
anti_join(kelp_metadata, kelp_otu, by = c("X.SampleID")) %>%
DT::datatable(rownames = FALSE)
anti_join(kelp_metadata, kelp_otu, by = c("X.SampleID"))
anti_join(kelp_otu, kelp_metadata, by = c("X.SampleID"))
anti_join(kelp_otu, kelp_metadata, by = c("X.SampleID")) %>%
DT::datatable()
anti_join(kelp_otu, kelp_metadata, by = c("X.SampleID"))
anti_join(kelp_metadata, kelp_otu, by = c("X.SampleID")) %>%
DT::datatable()
View(kelp_metadata)
